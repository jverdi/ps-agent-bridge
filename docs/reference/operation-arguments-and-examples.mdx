---
title: "Operation arguments and examples"
description: "Detailed argument contract and copy/paste examples for every supported operation."
---

Use this page as the source of truth when generating `ops` payloads. Canonical names and handlers are defined in `photoshop-uxp-bridge/index.js`.

## Shared conventions

- `target` can be omitted for layer-targeted ops if an active layer is selected; otherwise pass one of: layer name (`"Hero"`), layer id (`"123"`), or object (`{ "layerName": "Hero" }` / `{ "layerId": "123" }`).
- `docRef`/`target` for document ops defaults to the active document when omitted.
- Photoshop can change the active document between separate CLI invocations. Put dependent operations in a single `psagent op apply` envelope and set `doc.ref` explicitly.
- Ref assignment keys supported on any op: `ref`, `refId`, `as`, `outputRef`, `storeAs`, `idRef`.
- Ref keys are accepted on all operations; refs are most useful on ops that return a document/layer result (`createDocument`, `createLayer`, `createTextLayer`, `placeAsset`, etc.).
- Alias names listed below resolve to the same canonical op. Prefer canonical names in new prompts.
- `format` for export/save ops accepts common image/doc formats (`png`, `jpg`, `psd`), resolved by Photoshop save/export APIs.
- All examples are single-op snippets intended for the `ops` array.

## Documents

### `createDocument`

- Aliases: `doc.create`, `document.create`, `newDocument`
- Required: None
- Supported args: `depth`, `fill`, `height`, `mode`, `name`, `preset`, `profile`, `resolution`, `width`
- Notes: `mode` accepts Photoshop document mode enums (`rgb`, `cmyk`, `lab`, `grayscale`, `bitmap`, `indexedColor`, `multichannel`, `duotone`). `fill` accepts enum values (`white`, `black`, `transparent`, `backgroundColor`). Aliases like `rgbColor` are normalized for compatibility. Hex color strings are not valid `fill` values.

```json
{
  "op": "createDocument",
  "name": "New Doc",
  "width": 1080,
  "height": 1080,
  "resolution": 72,
  "mode": "rgb",
  "fill": "white"
}
```

### `openDocument`

- Aliases: `doc.open`, `document.open`
- Required: `input (or path/source)`
- Supported args: `input`, `path`, `source`

```json
{
  "op": "openDocument",
  "input": "./assets/source.psd"
}
```

### `duplicateDocument`

- Aliases: `doc.duplicate`, `document.duplicate`
- Required: None
- Supported args: `docRef`, `mergeLayersOnly`, `name`, `target`

```json
{
  "op": "duplicateDocument",
  "name": "Variant A"
}
```

### `saveDocument`

- Aliases: `doc.save`, `document.save`
- Required: None
- Supported args: `allowDialog`, `asCopy`, `docRef`, `options`, `output`, `quality`, `target`

```json
{
  "op": "saveDocument",
  "output": "./tmp/current.psd"
}
```

### `saveDocumentAs`

- Aliases: `doc.saveAs`, `document.saveAs`
- Required: `output`
- Supported args: `docRef`, `target`, `output`, `format`, `quality`, `asCopy`, `options`
- Notes: Use `output` for the destination path. `path` is not a supported key for this op.

```json
{
  "op": "saveDocumentAs",
  "output": "./tmp/output.psd"
}
```

### `closeDocument`

- Aliases: `doc.close`, `document.close`
- Required: None
- Supported args: `docRef`, `mode`, `output`, `save`, `saveChanges`, `saveOption`, `target`

```json
{
  "op": "closeDocument",
  "save": false
}
```

### `resizeImage`

- Aliases: `document.resizeImage`
- Required: `width` and/or `height`
- Supported args: `docRef`, `height`, `resolution`, `target`, `width`

```json
{
  "op": "resizeImage",
  "width": 1920,
  "height": 1080,
  "resolution": 72
}
```

### `resizeCanvas`

- Aliases: `document.resizeCanvas`
- Required: `width`, `height`
- Supported args: `anchor`, `docRef`, `height`, `target`, `width`

```json
{
  "op": "resizeCanvas",
  "width": 1200,
  "height": 1200,
  "anchor": "middleCenter"
}
```

### `cropDocument`

- Aliases: `document.crop`
- Required: `bounds {left, top, right, bottom}` (or top-level `left/top/right/bottom`)
- Supported args: `angle`, `bounds`, `docRef`, `height`, `target`, `width`

```json
{
  "op": "cropDocument",
  "bounds": {
    "left": 0,
    "top": 0,
    "right": 1080,
    "bottom": 1920
  }
}
```

### `trimDocument`

- Aliases: `document.trim`
- Required: None
- Supported args: `bottom`, `docRef`, `left`, `right`, `target`, `top`, `trimType`

```json
{
  "op": "trimDocument",
  "trimType": "transparent",
  "top": true,
  "left": true,
  "bottom": true,
  "right": true
}
```

### `rotateDocument`

- Aliases: `document.rotate`
- Required: `angle`
- Supported args: `anchor`, `angle`, `docRef`, `options`, `target`

```json
{
  "op": "rotateDocument",
  "angle": 90
}
```

### `changeDocumentMode`

- Aliases: `document.changeMode`
- Required: `mode (or to/newMode)`
- Supported args: `docRef`, `mode`, `newMode`, `target`, `to`

```json
{
  "op": "changeDocumentMode",
  "mode": "grayscale"
}
```

### `convertColorProfile`

- Aliases: `document.convertProfile`
- Required: `profile (or name/colorProfile)`
- Supported args: `blackPointCompensation`, `colorProfile`, `dither`, `docRef`, `intent`, `name`, `profile`, `target`

```json
{
  "op": "convertColorProfile",
  "profile": "Display P3",
  "intent": "relativeColorimetric",
  "blackPointCompensation": true
}
```

### `calculations`

- Aliases: `document.calculations`
- Required: None
- Supported args: `docRef`, `options`, `target`, plus calculation option fields

```json
{
  "op": "calculations",
  "options": {
    "result": "newChannel"
  }
}
```

### `applyImage`

- Aliases: `document.applyImage`
- Required: None
- Supported args: `docRef`, `options`, `target`, `targetLayer`, plus apply-image option fields

```json
{
  "op": "applyImage",
  "targetLayer": {
    "layerName": "Hero"
  },
  "options": {
    "blendMode": "multiply",
    "opacity": 65
  }
}
```

### `splitChannels`

- Aliases: `document.splitChannels`
- Required: None
- Supported args: `docRef`, `target`

```json
{
  "op": "splitChannels"
}
```

### `sampleColor`

- Aliases: `document.sampleColor`
- Required: `x/y (or position{x,y})`
- Supported args: `docRef`, `position`, `target`, `x`, `y`

```json
{
  "op": "sampleColor",
  "x": 220,
  "y": 340
}
```

### `createHistorySnapshot`

- Aliases: `history.snapshot`
- Required: None
- Supported args: `docRef`, `name`, `snapshotName`, `target`

```json
{
  "op": "createHistorySnapshot",
  "name": "Before Retouch"
}
```

### `listHistoryStates`

- Aliases: `history.list`
- Required: None
- Supported args: `docRef`, `target`

```json
{
  "op": "listHistoryStates"
}
```

### `restoreHistoryState`

- Aliases: `history.restore`
- Required: `historyStateId/id/historyStateName/name`
- Supported args: `docRef`, `historyStateId`, `historyStateName`, `id`, `name`, `target`

```json
{
  "op": "restoreHistoryState",
  "historyStateName": "Before Retouch"
}
```

### `suspendHistory`

- Aliases: `history.suspend`
- Required: `name/historyStateName`, `commands[] (or command/descriptor)`
- Supported args: `commands`, `command`, `descriptor`, `historyStateName`, `name`, `options`
- Notes: Wraps descriptors in one named history state where supported by Photoshop.

```json
{
  "op": "suspendHistory",
  "name": "Batch Style Update",
  "commands": [
    {
      "_obj": "set",
      "_target": [
        {
          "_ref": "layer",
          "_enum": "ordinal",
          "_value": "targetEnum"
        }
      ],
      "to": {
        "_obj": "layer",
        "opacity": {
          "_unit": "percentUnit",
          "_value": 80
        }
      }
    }
  ]
}
```

### `flattenDocument`

- Aliases: `flattenImage`, `document.flatten`
- Required: None
- Supported args: `docRef`, `target`

```json
{
  "op": "flattenDocument"
}
```

### `mergeVisible`

- Aliases: `mergeVisibleLayers`, `document.mergeVisibleLayers`
- Required: None
- Supported args: `docRef`, `target`

```json
{
  "op": "mergeVisible"
}
```

## Layers and grouping

### `createLayer`

- Aliases: `layer.create`
- Required: None
- Supported args: `blendMode`, `docRef`, `fillNeutral`, `kind`, `name`, `opacity`

```json
{
  "op": "createLayer",
  "name": "Foreground"
}
```

### `createPixelLayer`

- Aliases: `layer.createPixel`
- Required: None
- Supported args: `blendMode`, `docRef`, `fillNeutral`, `kind`, `name`, `opacity`

```json
{
  "op": "createPixelLayer",
  "name": "Paint"
}
```

### `createGroup`

- Aliases: `createLayerGroup`, `layer.createGroup`
- Required: None
- Supported args: `blendMode`, `docRef`, `fromLayers`, `name`, `opacity`

```json
{
  "op": "createGroup",
  "name": "Hero Group"
}
```

### `groupLayers`

- Aliases: `layer.group`
- Required: `targets[]`
- Supported args: `docRef`, `name`, `targets`

```json
{
  "op": "groupLayers",
  "targets": [
    {
      "layerName": "Title"
    },
    {
      "layerName": "CTA"
    }
  ],
  "name": "Header Group"
}
```

### `ungroupLayer`

- Aliases: `layer.ungroup`
- Required: None
- Supported args: No op-specific args

```json
{
  "op": "ungroupLayer",
  "target": {
    "layerName": "Header Group"
  }
}
```

### `deleteLayer`

- Aliases: `layer.delete`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "deleteLayer",
  "target": {
    "layerName": "Scratch"
  }
}
```

### `renameLayer`

- Aliases: `layer.rename`
- Required: `target (or active layer)`, `name (or newName)`
- Supported args: `name`

```json
{
  "op": "renameLayer",
  "target": {
    "layerName": "Layer 1"
  },
  "name": "Hero"
}
```

### `duplicateLayer`

- Aliases: `layer.duplicate`
- Required: `target (or active layer)`
- Supported args: `insertionLocation`, `name`, `placement`, `relativeTo`

```json
{
  "op": "duplicateLayer",
  "target": {
    "layerName": "Hero"
  },
  "name": "Hero Copy"
}
```

### `selectLayer`

- Aliases: `layer.select`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "selectLayer",
  "target": {
    "layerName": "Hero"
  }
}
```

### `selectLayers`

- Aliases: `layer.selectMany`
- Required: `targets[]`
- Supported args: `targets`

```json
{
  "op": "selectLayers",
  "targets": [
    {
      "layerName": "Hero"
    },
    {
      "layerName": "CTA"
    }
  ],
  "mode": "set"
}
```

### `moveLayer`

- Aliases: `layer.move`, `reorderLayer`, `layer.reorder`
- Required: `target (or active layer)`, `one of: by{x,y}, relativeTo+placement, to(front/back), or index/at`
- Supported args: `at`, `by`, `index`, `insertLocation`, `placement`, `relativeTo`, `to`

```json
{
  "op": "moveLayer",
  "target": {
    "layerName": "CTA"
  },
  "relativeTo": {
    "layerName": "Hero"
  },
  "placement": "placeAfter"
}
```

### `setLayerVisibility`

- Aliases: `layer.visibility`
- Required: `target (or active layer)`, `visible`
- Supported args: `visible`

```json
{
  "op": "setLayerVisibility",
  "target": {
    "layerName": "CTA"
  },
  "visible": true
}
```

### `showLayer`

- Aliases: `layer.show`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "showLayer",
  "target": {
    "layerName": "CTA"
  }
}
```

### `hideLayer`

- Aliases: `layer.hide`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "hideLayer",
  "target": {
    "layerName": "CTA"
  }
}
```

### `setLayerOpacity`

- Aliases: `layer.opacity`
- Required: `target (or active layer)`, `opacity`
- Supported args: `opacity`

```json
{
  "op": "setLayerOpacity",
  "target": {
    "layerName": "Hero"
  },
  "opacity": 80
}
```

### `setBlendMode`

- Aliases: `layer.blendMode`
- Required: `target (or active layer)`, `blendMode`
- Supported args: `blendMode`

```json
{
  "op": "setBlendMode",
  "target": {
    "layerName": "Texture"
  },
  "blendMode": "multiply"
}
```

### `setLayerProps`

- Aliases: `layer.setProps`
- Required: `target (or active layer)`
- Supported args: `blendMode`, `locked`, `opacity`, `visible`

```json
{
  "op": "setLayerProps",
  "target": {
    "layerName": "Hero"
  },
  "visible": true,
  "opacity": 90,
  "blendMode": "normal"
}
```

### `setLayerEffects`

- Aliases: `layer.effects`
- Required: `target (or active layer)` plus one of `effects`, effect fields, or `clear: true`
- Supported args: `bevelEmboss`, `clear`, `colorOverlay`, `dropShadow`, `effects`, `gradientOverlay`, `innerGlow`, `innerShadow`, `outerGlow`, `satin`, `scale`, `stroke`

```json
{
  "op": "setLayerEffects",
  "target": {
    "layerName": "Headline"
  },
  "dropShadow": {
    "color": "#000000",
    "opacity": 45,
    "angle": 120,
    "distance": 10,
    "size": 18
  },
  "stroke": {
    "color": "#ffffff",
    "size": 2,
    "position": "outside",
    "opacity": 100
  }
}
```

### `bringLayerToFront`

- Aliases: `layer.bringToFront`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "bringLayerToFront",
  "target": {
    "layerName": "CTA"
  }
}
```

### `sendLayerToBack`

- Aliases: `layer.sendToBack`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "sendLayerToBack",
  "target": {
    "layerName": "Background"
  }
}
```

### `mergeLayer`

- Aliases: `mergeLayers`, `layer.merge`
- Required: `target (or active layer)`
- Supported args: `name`, `targets`

```json
{
  "op": "mergeLayer",
  "target": {
    "layerName": "Overlay"
  }
}
```

### `rasterizeLayer`

- Aliases: `layer.rasterize`
- Required: `target (or active layer)`
- Supported args: `rasterizeType`, `targetType`

```json
{
  "op": "rasterizeLayer",
  "target": {
    "layerName": "Smart Object"
  }
}
```

### `linkLayers`

- Aliases: `layer.link`
- Required: `targets[]`
- Supported args: `targets`

```json
{
  "op": "linkLayers",
  "targets": [
    {
      "layerName": "Icon"
    },
    {
      "layerName": "Label"
    }
  ]
}
```

### `unlinkLayer`

- Aliases: `layer.unlink`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "unlinkLayer",
  "target": {
    "layerName": "Icon"
  }
}
```

### `createLayerComp`

- Aliases: `layerComp.create`
- Required: None
- Supported args: `captureAppearance`, `capturePosition`, `captureVisibility`, `comment`, `docRef`, `name`

```json
{
  "op": "createLayerComp",
  "name": "Hero Variant",
  "comment": "Primary hero layout"
}
```

### `applyLayerComp`

- Aliases: `layerComp.apply`
- Required: `layerComp target (name/id)`
- Supported args: `docRef`, `layerComp`, `layerCompId`, `layerCompName`, `name`, `target`

```json
{
  "op": "applyLayerComp",
  "layerComp": "Hero Variant"
}
```

### `recaptureLayerComp`

- Aliases: `layerComp.recapture`
- Required: `layerComp target (name/id)`
- Supported args: `captureAppearance`, `capturePosition`, `captureVisibility`, `childLayerCompState`, `docRef`, `layerComp`, `layerCompId`, `layerCompName`, `name`, `target`

```json
{
  "op": "recaptureLayerComp",
  "layerComp": "Hero Variant",
  "captureVisibility": true
}
```

### `deleteLayerComp`

- Aliases: `layerComp.delete`, `layerComp.remove`
- Required: `layerComp target (name/id)`
- Supported args: `docRef`, `layerComp`, `layerCompId`, `layerCompName`, `name`, `target`

```json
{
  "op": "deleteLayerComp",
  "layerComp": "Hero Variant"
}
```

### `createArtboard`

- Aliases: `artboard.create`
- Required: None
- Supported args: `bounds`, `docRef`, `frame`, `height`, `name`, `rect`, `target`, `width`, `x`, `y`
- Notes: If no bounds/frame/rect are supplied, the current document bounds are used.

```json
{
  "op": "createArtboard",
  "name": "Mobile",
  "x": 0,
  "y": 0,
  "width": 1080,
  "height": 1920
}
```

### `resizeArtboard`

- Aliases: `artboard.resize`
- Required: `target/artboard`, plus `bounds/frame/rect` or `x,y,width,height`
- Supported args: `artboard`, `artboardId`, `artboardName`, `bounds`, `frame`, `height`, `rect`, `target`, `width`, `x`, `y`

```json
{
  "op": "resizeArtboard",
  "target": {
    "layerName": "Mobile"
  },
  "width": 1200,
  "height": 1920,
  "x": 0,
  "y": 0
}
```

### `reorderArtboards`

- Aliases: `artboard.reorder`
- Required: `target/artboard`, plus one of `at`, `relativeTo+placement`, `to(front/back)`
- Supported args: `artboard`, `artboardId`, `artboardName`, `at`, `by`, `parent`, `placement`, `relativeTo`, `target`, `to`

```json
{
  "op": "reorderArtboards",
  "target": {
    "layerName": "Mobile"
  },
  "to": "front"
}
```

### `exportArtboards`

- Aliases: `artboard.export`
- Required: `outputDir` (or `commands[]/command/descriptor`)
- Supported args: `command`, `commands`, `descriptor`, `format`, `options`, `outputDir`
- Notes: Without explicit descriptors, this op uses a safe fallback export path; pass descriptor(s) for host-specific per-artboard export behavior.

```json
{
  "op": "exportArtboards",
  "outputDir": "./tmp/artboards",
  "format": "png"
}
```

## Transforms and layout

### `transformLayer`

- Aliases: `layer.transform`
- Required: `target (or active layer)`
- Supported args: `angle`, `angleH`, `angleV`, `axis`, `by`, `flip`, `height`, `horizontal`, `percent`, `rotate`, `scale`, `scaleX`, `scaleY`, `skewX`, `skewY`, `translate`, `vertical`, `width`, `x`, `y`
- Notes: For translation via `transformLayer`, pass top-level `x`/`y` (or `horizontal`/`vertical`). `translateLayer` uses the same movement fields.

```json
{
  "op": "transformLayer",
  "target": {
    "layerName": "Hero"
  },
  "scaleX": 95,
  "scaleY": 95,
  "rotate": 2
}
```

### `alignLayers`

- Aliases: `layer.align`
- Required: at least 2 layers via `targets[]` or current active selection
- Supported args: `targets`, `axis`, `type`

```json
{
  "op": "alignLayers",
  "axis": "horizontalCenter",
  "targets": [
    {
      "layerName": "Title"
    },
    {
      "layerName": "CTA"
    }
  ]
}
```

### `distributeLayers`

- Aliases: `layer.distribute`
- Required: at least 3 layers via `targets[]` or current active selection
- Supported args: `targets`, `axis`, `type`

```json
{
  "op": "distributeLayers",
  "axis": "horizontal",
  "targets": [
    {
      "layerName": "Card 1"
    },
    {
      "layerName": "Card 2"
    },
    {
      "layerName": "Card 3"
    }
  ]
}
```

### `autoAlignLayers`

- Aliases: `layer.autoAlign`
- Required: at least 2 layers via `targets[]` or current active selection
- Supported args: `mode`, `projection`, `targets`, `using`
- Notes: `mode/projection` supports `auto`, `perspective`, `cylindrical`, `spherical`, `reposition`.

```json
{
  "op": "autoAlignLayers",
  "mode": "auto",
  "targets": [
    {
      "layerName": "Frame 01"
    },
    {
      "layerName": "Frame 02"
    }
  ]
}
```

### `autoBlendLayers`

- Aliases: `layer.autoBlend`
- Required: at least 2 layers via `targets[]` or current active selection
- Supported args: `contentAwareFillTransparentAreas`, `mode`, `seamlessTonesAndColors`, `targets`
- Notes: `mode` supports `panorama` and `stackImages`.

```json
{
  "op": "autoBlendLayers",
  "mode": "panorama",
  "seamlessTonesAndColors": true,
  "contentAwareFillTransparentAreas": true,
  "targets": [
    {
      "layerName": "Frame 01"
    },
    {
      "layerName": "Frame 02"
    }
  ]
}
```

### `translateLayer`

- Aliases: `layer.translate`
- Required: `target (or active layer)`, `x/y or horizontal/vertical`
- Supported args: `by`, `horizontal`, `vertical`, `x`, `y`

```json
{
  "op": "translateLayer",
  "target": {
    "layerName": "Badge"
  },
  "x": 12,
  "y": -8
}
```

### `scaleLayer`

- Aliases: `layer.scale`
- Required: `target (or active layer)`, `scaleX/scaleY or width/height or scale/percent`
- Supported args: `anchor`, `height`, `options`, `percent`, `scale`, `scaleX`, `scaleY`, `width`

```json
{
  "op": "scaleLayer",
  "target": {
    "layerName": "Logo"
  },
  "scaleX": 120,
  "scaleY": 120
}
```

### `rotateLayer`

- Aliases: `layer.rotate`
- Required: `target (or active layer)`, `angle`
- Supported args: `anchor`, `angle`, `options`

```json
{
  "op": "rotateLayer",
  "target": {
    "layerName": "Badge"
  },
  "angle": -12
}
```

### `flipLayer`

- Aliases: `layer.flip`
- Required: `target (or active layer)`, `axis`
- Supported args: `axis`

```json
{
  "op": "flipLayer",
  "target": {
    "layerName": "Hero"
  },
  "axis": "horizontal"
}
```

### `skewLayer`

- Aliases: `layer.skew`
- Required: `target (or active layer)`, `angleH and/or angleV`
- Supported args: `angleH`, `angleV`, `horizontal`, `options`, `vertical`

```json
{
  "op": "skewLayer",
  "target": {
    "layerName": "Card"
  },
  "angleH": 8
}
```

## Assets and smart objects

### `placeAsset`

- Aliases: `asset.place`
- Required: `input (or path/source)`
- Supported args: `input`, `linked`, `name`, `normalizePixels`, `path`, `source`, `transformOptions`

```json
{
  "op": "placeAsset",
  "input": "https://picsum.photos/seed/hero/1080/1080.jpg",
  "name": "Hero Image"
}
```

### `convertToSmartObject`

- Aliases: `smartObject.convert`
- Required: `target (or active layer)`
- Supported args: `preserveName`

```json
{
  "op": "convertToSmartObject",
  "target": {
    "layerName": "Hero Image"
  }
}
```

### `replaceSmartObject`

- Aliases: `smartObject.replace`
- Required: `target (or active layer)`, `input (or path/source)`
- Supported args: `crop`, `input`, `pageNumber`, `path`, `preserveName`, `source`

```json
{
  "op": "replaceSmartObject",
  "target": {
    "layerName": "Hero Image"
  },
  "input": "./assets/new-hero.jpg"
}
```

### `relinkSmartObject`

- Aliases: `smartObject.relink`
- Required: `target (or active layer)`, `input (or path/source)`
- Supported args: `input`, `path`, `preserveName`, `source`

```json
{
  "op": "relinkSmartObject",
  "target": {
    "layerName": "Hero Image"
  },
  "input": "./assets/linked-hero.psb"
}
```

### `editSmartObject`

- Aliases: `smartObject.edit`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "editSmartObject",
  "target": {
    "layerName": "Hero Image"
  }
}
```

## Selection and masks

### `selectAll`

- Aliases: `selection.selectAll`
- Required: None
- Supported args: `docRef`

```json
{
  "op": "selectAll"
}
```

### `deselect`

- Aliases: `selection.deselect`
- Required: None
- Supported args: `docRef`

```json
{
  "op": "deselect"
}
```

### `inverseSelection`

- Aliases: `invertSelection`, `selection.inverse`
- Required: None
- Supported args: `docRef`

```json
{
  "op": "inverseSelection"
}
```

### `featherSelection`

- Aliases: `selection.feather`
- Required: `by or radius`
- Supported args: `applyEffectAtCanvasBounds`, `by`, `docRef`, `radius`

```json
{
  "op": "featherSelection",
  "radius": 8
}
```

### `expandSelection`

- Aliases: `selection.expand`
- Required: `by`
- Supported args: `applyEffectAtCanvasBounds`, `by`, `docRef`

```json
{
  "op": "expandSelection",
  "by": 12
}
```

### `contractSelection`

- Aliases: `selection.contract`
- Required: `by`
- Supported args: `applyEffectAtCanvasBounds`, `by`, `docRef`

```json
{
  "op": "contractSelection",
  "by": 8
}
```

### `growSelection`

- Aliases: `selection.grow`
- Required: `by or tolerance`
- Supported args: `by`, `docRef`, `tolerance`

```json
{
  "op": "growSelection",
  "tolerance": 32
}
```

### `smoothSelection`

- Aliases: `selection.smooth`
- Required: `radius`
- Supported args: `applyEffectAtCanvasBounds`, `docRef`, `radius`

```json
{
  "op": "smoothSelection",
  "radius": 6
}
```

### `selectSubject`

- Aliases: `selection.subject`
- Required: None
- Supported args: `allLayers`, `docRef`, `sampleAllLayers`, `target`

```json
{
  "op": "selectSubject",
  "sampleAllLayers": true
}
```

### `selectColorRange`

- Aliases: `selection.colorRange`
- Required: None (or pass `descriptor`)
- Supported args: `color`, `descriptor`, `docRef`, `fuzziness`, `invert`, `localizedColorClusters`, `options`, `sampledColor`, `strict`, `target`
- Notes: Pass `descriptor` for advanced/host-specific Color Range options. Shorthand mode is best-effort; set `strict: true` to fail when Photoshop rejects shorthand descriptors.

```json
{
  "op": "selectColorRange",
  "color": "#22c55e",
  "fuzziness": 40
}
```

### `refineSelection`

- Aliases: `selection.refine`
- Required: None (or pass `descriptor`)
- Supported args: `contrast`, `decontaminateAmount`, `decontaminateColors`, `descriptor`, `docRef`, `feather`, `options`, `output`, `outputTo`, `radius`, `shiftEdge`, `smartRadius`, `smooth`, `strict`, `target`
- Notes: Uses Photoshop refine-edge behavior; pass `descriptor` for full host-specific control. Shorthand mode is best-effort; set `strict: true` to fail when Photoshop rejects shorthand descriptors.

```json
{
  "op": "refineSelection",
  "radius": 2,
  "smooth": 4,
  "feather": 0.8,
  "contrast": 10,
  "shiftEdge": -5,
  "output": "selection"
}
```

### `selectRectangle`

- Aliases: `selection.selectRectangle`
- Required: `bounds {left,top,right,bottom}`
- Supported args: `antiAlias`, `bounds`, `docRef`, `feather`, `mode`

```json
{
  "op": "selectRectangle",
  "bounds": {
    "left": 80,
    "top": 80,
    "right": 1000,
    "bottom": 1400
  },
  "mode": "replace"
}
```

### `selectEllipse`

- Aliases: `selection.selectEllipse`
- Required: `bounds {left,top,right,bottom}`
- Supported args: `antiAlias`, `bounds`, `docRef`, `feather`, `mode`

```json
{
  "op": "selectEllipse",
  "bounds": {
    "left": 220,
    "top": 260,
    "right": 860,
    "bottom": 900
  },
  "mode": "replace"
}
```

### `selectPolygon`

- Aliases: `selection.selectPolygon`
- Required: `points[3+]`
- Supported args: `antiAlias`, `docRef`, `feather`, `mode`, `points`

```json
{
  "op": "selectPolygon",
  "points": [
    {
      "x": 100,
      "y": 100
    },
    {
      "x": 900,
      "y": 120
    },
    {
      "x": 560,
      "y": 900
    }
  ],
  "mode": "replace"
}
```

### `selectLayerPixels`

- Aliases: `selection.loadLayerPixels`
- Required: `target (or active layer)`
- Supported args: `docRef`, `invert`, `mode`

```json
{
  "op": "selectLayerPixels",
  "target": {
    "layerName": "Logo"
  },
  "mode": "replace"
}
```

### `createChannel`

- Aliases: `channel.create`
- Required: None
- Supported args: `docRef`, `name`

```json
{
  "op": "createChannel",
  "name": "Mask Alpha"
}
```

### `duplicateChannel`

- Aliases: `channel.duplicate`
- Required: `channel/target`
- Supported args: `channel`, `channelId`, `channelName`, `docRef`, `name`, `target`

```json
{
  "op": "duplicateChannel",
  "channel": "Mask Alpha",
  "name": "Mask Alpha Copy"
}
```

### `deleteChannel`

- Aliases: `channel.delete`, `channel.remove`
- Required: `channel/target`
- Supported args: `channel`, `channelId`, `channelName`, `docRef`, `target`

```json
{
  "op": "deleteChannel",
  "channel": "Mask Alpha Copy"
}
```

### `saveSelection`

- Aliases: `selection.save`
- Required: None
- Supported args: `channel`, `channelId`, `channelName`, `docRef`, `name`, `target`

```json
{
  "op": "saveSelection",
  "name": "Saved Selection 1"
}
```

### `saveSelectionTo`

- Aliases: `selection.saveTo`
- Required: None
- Supported args: `channel`, `channelId`, `channelName`, `docRef`, `name`, `target`

```json
{
  "op": "saveSelectionTo",
  "channel": "Saved Selection 1"
}
```

### `loadSelection`

- Aliases: `selection.load`
- Required: `channel/target`
- Supported args: `channel`, `channelId`, `channelName`, `docRef`, `invert`, `mode`, `target`

```json
{
  "op": "loadSelection",
  "channel": "Saved Selection 1"
}
```

### `createPath`

- Aliases: `path.create`
- Required: active selection
- Supported args: `docRef`, `name`, `tolerance`
- Notes: First-class `createPath` builds a work path from the current selection.

```json
{
  "op": "createPath",
  "name": "Subject Path",
  "tolerance": 2
}
```

### `createPathFromPoints`

- Aliases: `path.createFromPoints`
- Required: `points[2+]`
- Supported args: `closed`, `docRef`, `name`, `operation`, `points`, `shapeOperation`, `target`
- Notes: Each point accepts `{x,y}` (or `anchor:[x,y]`) with optional handles as either `leftDirection/rightDirection` or `backward/forward`, plus optional `smooth`/`kind`. If Photoshop rejects explicit point descriptors in your version, psagent falls back to a polygon-selection work-path conversion (straight segments only).

```json
{
  "op": "createPathFromPoints",
  "name": "Diamond",
  "closed": true,
  "points": [
    { "x": 540, "y": 120 },
    { "x": 920, "y": 540 },
    { "x": 540, "y": 960 },
    { "x": 160, "y": 540 }
  ]
}
```

### `setPathPoints`

- Aliases: `path.setPoints`
- Required: `path/target`, `points[2+]`
- Supported args: `closed`, `docRef`, `name`, `operation`, `path`, `pathId`, `pathName`, `points`, `shapeOperation`, `target`
- Notes: Point format matches `createPathFromPoints` (`x/y` or `anchor`, optional handle pairs, optional `smooth`/`kind`).

```json
{
  "op": "setPathPoints",
  "path": "Diamond",
  "points": [
    { "x": 540, "y": 160 },
    { "x": 900, "y": 540 },
    { "x": 540, "y": 920 },
    { "x": 180, "y": 540 }
  ]
}
```

### `deletePath`

- Aliases: `path.delete`, `path.remove`
- Required: `path/target`
- Supported args: `docRef`, `path`, `pathId`, `pathName`, `target`

```json
{
  "op": "deletePath",
  "path": "Subject Path"
}
```

### `makeWorkPathFromSelection`

- Aliases: `path.makeWorkPath`, `selection.makeWorkPath`
- Required: active selection
- Supported args: `docRef`, `name`, `tolerance`

```json
{
  "op": "makeWorkPathFromSelection",
  "name": "Work Path",
  "tolerance": 2
}
```

### `makeSelectionFromPath`

- Aliases: `path.makeSelection`
- Required: `path/target`
- Supported args: `antiAlias`, `docRef`, `feather`, `mode`, `path`, `pathId`, `pathName`, `target`

```json
{
  "op": "makeSelectionFromPath",
  "path": "Subject Path",
  "mode": "replace"
}
```

### `fillPath`

- Aliases: `path.fill`
- Required: `path/target`
- Supported args: `antiAlias`, `blendMode`, `color`, `docRef`, `feather`, `fillColor`, `opacity`, `path`, `pathId`, `pathName`, `preserveTransparency`, `target`

```json
{
  "op": "fillPath",
  "path": "Subject Path",
  "fillColor": "#22c55e",
  "opacity": 90
}
```

### `strokePath`

- Aliases: `path.stroke`
- Required: `path/target`
- Supported args: `docRef`, `paintTool`, `path`, `pathId`, `pathName`, `simulatePressure`, `target`, `tool`

```json
{
  "op": "strokePath",
  "path": "Subject Path",
  "tool": "brush"
}
```

### `makeClippingPath`

- Aliases: `path.makeClippingPath`
- Required: `path/target`
- Supported args: `docRef`, `flatness`, `path`, `pathId`, `pathName`, `target`

```json
{
  "op": "makeClippingPath",
  "path": "Subject Path",
  "flatness": 1
}
```

### `addGuide`

- Aliases: `guide.add`
- Required: `position/coordinate/value`
- Supported args: `direction`, `docRef`, `orientation`, `position`, `coordinate`, `value`

```json
{
  "op": "addGuide",
  "direction": "vertical",
  "position": 540
}
```

### `removeGuide`

- Aliases: `guide.remove`, `guide.delete`
- Required: None
- Supported args: `docRef`, `index`

```json
{
  "op": "removeGuide",
  "index": 0
}
```

### `clearGuides`

- Aliases: `guide.clear`, `guide.removeAll`
- Required: None
- Supported args: `docRef`

```json
{
  "op": "clearGuides"
}
```

### `setSelection`

- Aliases: `selection.set`
- Required: shape-dependent coordinates (`rect`/`ellipse`: `x,y,width,height`; `polygon`: `points[3+]`)
- Supported args: `shape`, `type`, `x`, `y`, `left`, `top`, `width`, `height`, `points`, `mode`, `feather`, `antiAlias`

```json
{
  "op": "setSelection",
  "shape": "rect",
  "x": 120,
  "y": 120,
  "width": 600,
  "height": 320
}
```

### `modifySelection`

- Aliases: `selection.modify`
- Required: `mode` plus mode-specific args (`expand`/`contract`: `by`; `feather`/`smooth`: `radius`; `grow`: `by` or `tolerance`)
- Supported args: `mode`, `by`, `radius`, `tolerance`, `applyEffectAtCanvasBounds`

```json
{
  "op": "modifySelection",
  "mode": "expand",
  "by": 10
}
```

### `createLayerMask`

- Aliases: `layerMask.create`
- Required: `target (or active layer)`
- Supported args: `forceBatchPlay`, `fromSelection`, `hideAll`

```json
{
  "op": "createLayerMask",
  "target": {
    "layerName": "Hero"
  },
  "fromSelection": true
}
```

### `addLayerMask`

- Aliases: `layerMask.add`
- Required: `target (or active layer)`
- Supported args: `forceBatchPlay`, `fromSelection`, `hideAll`

```json
{
  "op": "addLayerMask",
  "target": {
    "layerName": "Hero"
  },
  "fromSelection": true
}
```

### `deleteLayerMask`

- Aliases: `layerMask.delete`
- Required: `target (or active layer)`
- Supported args: `apply`, `forceBatchPlay`

```json
{
  "op": "deleteLayerMask",
  "target": {
    "layerName": "Hero"
  },
  "apply": false
}
```

### `removeLayerMask`

- Aliases: `layerMask.remove`
- Required: `target (or active layer)`
- Supported args: `apply`, `forceBatchPlay`

```json
{
  "op": "removeLayerMask",
  "target": {
    "layerName": "Hero"
  },
  "apply": false
}
```

### `applyLayerMask`

- Aliases: `layerMask.apply`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "applyLayerMask",
  "target": {
    "layerName": "Hero"
  }
}
```

### `createClippingMask`

- Aliases: `layerMask.clip`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "createClippingMask",
  "target": {
    "layerName": "Placed Photo"
  }
}
```

### `releaseClippingMask`

- Aliases: `layerMask.unclip`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "releaseClippingMask",
  "target": {
    "layerName": "Placed Photo"
  }
}
```

### `createVectorMask`

- Aliases: `vectorMask.create`, `layerMask.vectorCreate`
- Required: `target (or active layer)`
- Supported args: `path`, `pathId`, `pathName`, `target`

```json
{
  "op": "createVectorMask",
  "target": {
    "layerName": "Placed Photo"
  },
  "path": "Subject Path"
}
```

### `deleteVectorMask`

- Aliases: `vectorMask.delete`, `layerMask.vectorDelete`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "deleteVectorMask",
  "target": {
    "layerName": "Placed Photo"
  }
}
```

## Adjustments and filters

### `createAdjustmentLayer`

- Aliases: `adjustment.create`
- Required: None (`levels` default when omitted)
- Supported args: `adjustment`, `kind`, `name`, `settings`, `type`, plus adjustment fields
- Notes: Pass either (a) `type`/`kind` + settings fields, (b) `adjustment` as a plain object (`{ "brightness": 10, ... }`), or (c) `adjustment` as a raw descriptor with `_obj`.

```json
{
  "op": "createAdjustmentLayer",
  "type": "brightnessContrast",
  "adjustment": {
    "brightness": 8,
    "contrast": 12
  },
  "name": "Grade"
}
```

### `setAdjustmentLayer`

- Aliases: `adjustment.set`
- Required: `target (or active layer)` and adjustment descriptor or kind/settings
- Supported args: `adjustment`, `kind`, `settings`, `target`, `type`, plus adjustment fields

```json
{
  "op": "setAdjustmentLayer",
  "target": {
    "layerName": "Grade"
  },
  "type": "hueSaturation",
  "adjustment": {
    "masterHue": 8,
    "masterSaturation": -10,
    "masterLightness": 4
  }
}
```

### `applyFilter`

- Aliases: `filter.apply`
- Required: `filter (or kind)`
- Supported args: `filter`, `kind`

```json
{
  "op": "applyFilter",
  "target": {
    "layerName": "Hero"
  },
  "filter": "gaussianBlur",
  "radius": 4
}
```

### `applyGaussianBlur`

- Aliases: `filter.gaussianBlur`
- Required: `target (or active layer)`, `radius`
- Supported args: `radius`

```json
{
  "op": "applyGaussianBlur",
  "target": {
    "layerName": "Hero"
  },
  "radius": 3
}
```

### `applyAddNoise`

- Aliases: `filter.addNoise`, `applyNoise`, `filter.noise`
- Required: `target (or active layer)`, `amount`
- Supported args: `amount`, `distribution`, `monochromatic`

```json
{
  "op": "applyAddNoise",
  "target": {
    "layerName": "Texture"
  },
  "amount": 8,
  "distribution": "uniform",
  "monochromatic": true
}
```

### `applyUnsharpMask`

- Aliases: `filter.unsharpMask`
- Required: `target (or active layer)`, `amount, radius, threshold`
- Supported args: `amount`, `radius`, `threshold`

```json
{
  "op": "applyUnsharpMask",
  "target": {
    "layerName": "Hero"
  },
  "amount": 80,
  "radius": 1.5,
  "threshold": 2
}
```

### `applySharpen`

- Aliases: `filter.sharpen`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "applySharpen",
  "target": {
    "layerName": "Hero"
  }
}
```

### `applyBlur`

- Aliases: `filter.blur`
- Required: `target (or active layer)`
- Supported args: No op-specific args

```json
{
  "op": "applyBlur",
  "target": {
    "layerName": "Hero"
  }
}
```

### `applyMotionBlur`

- Aliases: `filter.motionBlur`
- Required: `target (or active layer)`, `angle`, `radius`
- Supported args: `angle`, `radius`

```json
{
  "op": "applyMotionBlur",
  "target": {
    "layerName": "Hero"
  },
  "angle": 18,
  "radius": 24
}
```

### `applySmartBlur`

- Aliases: `filter.smartBlur`
- Required: `target (or active layer)`, `radius`, `threshold`
- Supported args: `mode`, `quality`, `radius`, `threshold`

```json
{
  "op": "applySmartBlur",
  "target": {
    "layerName": "Hero"
  },
  "radius": 3,
  "threshold": 12,
  "quality": "high",
  "mode": "normal"
}
```

### `applyHighPass`

- Aliases: `filter.highPass`
- Required: `target (or active layer)`, `radius`
- Supported args: `radius`

```json
{
  "op": "applyHighPass",
  "target": {
    "layerName": "Hero"
  },
  "radius": 2
}
```

### `applyMedianNoise`

- Aliases: `filter.median`
- Required: `target (or active layer)`, `radius`
- Supported args: `radius`

```json
{
  "op": "applyMedianNoise",
  "target": {
    "layerName": "Texture"
  },
  "radius": 3
}
```

### `applyMinimum`

- Aliases: `filter.minimum`
- Required: `target (or active layer)`, `radius`
- Supported args: `radius`

```json
{
  "op": "applyMinimum",
  "target": {
    "layerName": "Mask"
  },
  "radius": 1
}
```

### `applyMaximum`

- Aliases: `filter.maximum`
- Required: `target (or active layer)`, `radius`
- Supported args: `radius`

```json
{
  "op": "applyMaximum",
  "target": {
    "layerName": "Mask"
  },
  "radius": 1
}
```

### `applyDustAndScratches`

- Aliases: `filter.dustAndScratches`
- Required: `target (or active layer)`, `radius`, `threshold`
- Supported args: `radius`, `threshold`

```json
{
  "op": "applyDustAndScratches",
  "target": {
    "layerName": "Texture"
  },
  "radius": 2,
  "threshold": 4
}
```

### `contentAwareFill`

- Aliases: `contentAware.fill`
- Required: active selection (or pass `descriptor` with custom behavior)
- Supported args: `colorAdaptation`, `descriptor`, `docRef`, `mirror`, `options`, `rotationAdaptation`, `scale`, `target`

```json
{
  "op": "contentAwareFill",
  "colorAdaptation": true,
  "rotationAdaptation": false
}
```

### `contentAwareScale`

- Aliases: `contentAware.scale`
- Required: `target (or active layer)`
- Supported args: `descriptor`, `height`, `options`, `scale`, `scaleX`, `scaleY`, `target`, `width`

```json
{
  "op": "contentAwareScale",
  "target": {
    "layerName": "Hero"
  },
  "scaleX": 95,
  "scaleY": 95
}
```

### `contentAwareMove`

- Aliases: `contentAware.move`
- Required: `target (or active layer)`
- Supported args: `adaptation`, `color`, `descriptor`, `dx`, `dy`, `horizontal`, `options`, `structure`, `target`, `vertical`, `x`, `y`

```json
{
  "op": "contentAwareMove",
  "target": {
    "layerName": "Hero"
  },
  "x": 24,
  "y": -12,
  "adaptation": "veryStrict"
}
```

## Text and shapes

### `createTextLayer`

- Aliases: `text.create`
- Required: `text (or contents)`
- Supported args: `alignment`, `align`, `avoidOverlapWith`, `color`, `contents`, `docRef`, `ellipsis`, `font`, `fontName`, `fontSize`, `hardMinFontSize`, `justification`, `maxHeight`, `maxWidth`, `minFontSize`, `name`, `overflow`, `overflowMode`, `overlapGap`, `position`, `text`, `textColor`
- Notes: `position.y` is the text baseline, not the top of glyph bounds. For large display text, place the baseline lower than the desired visual top. `createTextLayer` already accepts style/fitting args; use `setTextStyle` for post-create updates.

```json
{
  "op": "createTextLayer",
  "name": "Headline",
  "text": "Summer Launch",
  "fontSize": 72,
  "textColor": "#ffffff",
  "alignment": "center",
  "position": {
    "x": 0,
    "y": 220
  },
  "maxWidth": 1080
}
```

### `setText`

- Aliases: `text.set`
- Required: `target (or active layer)`, `text (or contents)`
- Supported args: `contents`, `text`

```json
{
  "op": "setText",
  "target": {
    "layerName": "Headline"
  },
  "text": "New headline copy"
}
```

### `setTextStyle`

- Aliases: `text.style`
- Required: `target (or active layer)`, `at least one style/content field`
- Supported args: `alignment`, `align`, `avoidOverlapWith`, `color`, `contents`, `ellipsis`, `font`, `fontName`, `fontSize`, `hardMinFontSize`, `justification`, `maxHeight`, `maxWidth`, `minFontSize`, `overflow`, `overflowMode`, `overlapGap`, `position`, `text`, `textColor`

```json
{
  "op": "setTextStyle",
  "target": {
    "layerName": "Headline"
  },
  "font": "Avenir Next",
  "textColor": "#f8fafc",
  "alignment": "center",
  "fontSize": 64,
  "maxWidth": 860,
  "overflow": "resize"
}
```

### `setTextWarp`

- Aliases: `text.warp`
- Required: `target (or active layer)` and at least one warp field
- Supported args: `bend`, `horizontalDistortion`, `orientation`, `style`, `target`, `verticalDistortion`, `warpPerspective`, `warpPerspectiveOther`, `warpStyle`, `warpValue`

```json
{
  "op": "setTextWarp",
  "target": {
    "layerName": "Headline"
  },
  "style": "arc",
  "bend": 24,
  "horizontalDistortion": 0,
  "verticalDistortion": 0
}
```

### `setTextOnPath`

- Aliases: `text.onPath`
- Required: `target (or active layer)` and `path/pathName/pathId` (or `commands[]/command/descriptor`)
- Supported args: `command`, `commands`, `descriptor`, `options`, `orientation`, `path`, `pathId`, `pathName`, `strict`, `target`, `targetPath`
- Notes: Photoshop text-on-path descriptors vary by host build. The shorthand payload is best-effort; pass explicit `commands`/`descriptor` for deterministic behavior. Set `strict: true` to fail when shorthand application is rejected.

```json
{
  "op": "setTextOnPath",
  "target": {
    "layerName": "Headline"
  },
  "path": "Subject Path",
  "orientation": "horizontal"
}
```

### `createShapeLayer`

- Aliases: `shape.create`
- Required: `bounds or x/y/width/height`
- Supported args: `bounds`, `color`, `cornerRadius`, `fill`, `fillType`, `gradient`, `gradientAngle`, `gradientFrom`, `gradientScale`, `gradientTo`, `gradientType`, `height`, `name`, `radius`, `shape`, `shapeType`, `width`, `x`, `y`

```json
{
  "op": "createShapeLayer",
  "name": "CTA Button",
  "shape": "rectangle",
  "x": 88,
  "y": 980,
  "width": 320,
  "height": 92,
  "fillType": "gradient",
  "cornerRadius": 46,
  "gradient": {
    "from": "#22c55e",
    "to": "#15803d",
    "angle": 90
  }
}
```

## Export and low-level

### `export`

- Aliases: `document.export`, `render`
- Required: `output`
- Supported args: `docRef`, `target`, `output`, `format`, `quality`, `metadata`, `sRGB`, `options`

```json
{
  "op": "export",
  "output": "./tmp/frame.png",
  "format": "png",
  "quality": 90
}
```

### `exportDocument`

- Aliases: `document.exportDocument`
- Required: `output`
- Supported args: `docRef`, `output`, `format`, `quality`, `metadata`, `sRGB`, `options`

```json
{
  "op": "exportDocument",
  "output": "./tmp/document.png",
  "format": "png"
}
```

### `exportLayer`

- Aliases: `document.exportLayer`
- Required: `target (or active layer)`, `output`
- Supported args: `target`, `docRef`, `output`, `format`, `quality`, `metadata`, `sRGB`, `options`

```json
{
  "op": "exportLayer",
  "target": {
    "layerName": "Hero"
  },
  "output": "./tmp/hero.png",
  "format": "png"
}
```

### `exportLayersByName`

- Aliases: `document.exportLayersByName`
- Required: `match`, `outputDir (or output)`
- Supported args: `docRef`, `format`, `match`, `output`, `outputDir`

```json
{
  "op": "exportLayersByName",
  "match": "^(Hero|CTA)$",
  "format": "png",
  "outputDir": "./tmp/layers"
}
```

### `exportArtboards`

- Aliases: `artboard.export`
- Required: `outputDir` (or `commands[]/command/descriptor`)
- Supported args: `command`, `commands`, `descriptor`, `format`, `options`, `outputDir`
- Notes: For explicit multi-artboard export behavior across Photoshop versions, prefer `descriptor`/`commands`.

```json
{
  "op": "exportArtboards",
  "outputDir": "./tmp/artboards",
  "format": "png"
}
```

### `getPixels`

- Aliases: `imaging.getPixels`
- Required: None
- Supported args: `componentSize`, `colorSpace`, `docRef`, `includeData`, `options`, `sourceBounds`, `target`, `targetBounds`, `targetSize`

```json
{
  "op": "getPixels",
  "target": {
    "layerName": "Hero"
  },
  "sourceBounds": {
    "left": 0,
    "top": 0,
    "right": 512,
    "bottom": 512
  },
  "includeData": false
}
```

### `putPixels`

- Aliases: `imaging.putPixels`
- Required: `imageData/pixels`
- Supported args: `componentSize`, `colorSpace`, `docRef`, `imageData`, `options`, `pixels`, `target`, `targetBounds`

```json
{
  "op": "putPixels",
  "target": {
    "layerName": "Hero"
  },
  "imageData": {
    "width": 64,
    "height": 64,
    "components": 4,
    "componentSize": 8,
    "colorSpace": "RGB",
    "data": "BASE64_ENCODED_BYTES"
  }
}
```

### `getSelectionPixels`

- Aliases: `imaging.getSelection`
- Required: None
- Supported args: `componentSize`, `colorSpace`, `docRef`, `includeData`, `options`, `sourceBounds`, `targetBounds`, `targetSize`

```json
{
  "op": "getSelectionPixels",
  "includeData": false
}
```

### `putSelectionPixels`

- Aliases: `imaging.putSelection`
- Required: `imageData/pixels`
- Supported args: `componentSize`, `colorSpace`, `docRef`, `imageData`, `options`, `pixels`, `targetBounds`

```json
{
  "op": "putSelectionPixels",
  "imageData": {
    "width": 64,
    "height": 64,
    "components": 1,
    "componentSize": 8,
    "colorSpace": "Grayscale",
    "data": "BASE64_ENCODED_BYTES"
  }
}
```

### `getLayerMaskPixels`

- Aliases: `imaging.getLayerMask`
- Required: `target (or active layer)`
- Supported args: `componentSize`, `colorSpace`, `docRef`, `includeData`, `options`, `sourceBounds`, `target`, `targetBounds`, `targetSize`

```json
{
  "op": "getLayerMaskPixels",
  "target": {
    "layerName": "Hero"
  },
  "includeData": false
}
```

### `putLayerMaskPixels`

- Aliases: `imaging.putLayerMask`
- Required: `target (or active layer)`, `imageData/pixels`
- Supported args: `componentSize`, `colorSpace`, `docRef`, `imageData`, `options`, `pixels`, `target`, `targetBounds`

```json
{
  "op": "putLayerMaskPixels",
  "target": {
    "layerName": "Hero"
  },
  "imageData": {
    "width": 64,
    "height": 64,
    "components": 1,
    "componentSize": 8,
    "colorSpace": "Grayscale",
    "data": "BASE64_ENCODED_BYTES"
  }
}
```

### `encodeImageData`

- Aliases: `imaging.encodeImageData`
- Required: `imageData/pixels`
- Supported args: `format`, `imageData`, `options`, `pixels`, `quality`

```json
{
  "op": "encodeImageData",
  "format": "png",
  "imageData": {
    "width": 64,
    "height": 64,
    "components": 4,
    "componentSize": 8,
    "colorSpace": "RGB",
    "data": "BASE64_ENCODED_BYTES"
  }
}
```

### `playAction`

- Aliases: `action.play`
- Required: `action/name` and `actionSet/set`
- Supported args: `action`, `actionSet`, `name`, `set`, `setName`

```json
{
  "op": "playAction",
  "actionSet": "My Set",
  "action": "Warm Grade"
}
```

### `playActionSet`

- Aliases: `actionSet.play`
- Required: `actionSet/set/name`
- Supported args: `action`, `actionSet`, `name`, `set`, `setName`

```json
{
  "op": "playActionSet",
  "actionSet": "My Set"
}
```

### `batchPlay`

- Aliases: `action.batchPlay`
- Required: `commands[] or command/descriptor`
- Supported args: `allowUnavailable`, `command`, `commands`, `descriptor`, `options`
- Notes: `textStyleRange[*].textStyle` replaces style objects rather than patching them. Include every style field you need to preserve (font family/style, size, color, etc.), or use first-class text ops (`createTextLayer` / `setTextStyle`) when possible.

```json
{
  "op": "batchPlay",
  "commands": [
    {
      "_obj": "set",
      "_target": [
        {
          "_ref": "textLayer",
          "_name": "Headline"
        }
      ],
      "to": {
        "_obj": "textLayer",
        "textStyleRange": [
          {
            "_obj": "textStyleRange",
            "from": 0,
            "to": 8,
            "textStyle": {
              "_obj": "textStyle",
              "fontPostScriptName": "Impact",
              "fontName": "Impact",
              "fontStyleName": "Regular",
              "size": {
                "_obj": "unitDouble",
                "_unit": "pointsUnit",
                "_value": 200
              },
              "color": {
                "_obj": "RGBColor",
                "red": 255,
                "green": 255,
                "blue": 255
              }
            }
          }
        ]
      }
    }
  ]
}
```

```json
{
  "op": "batchPlay",
  "commands": [
    {
      "_obj": "get",
      "_target": [
        {
          "_ref": "document",
          "_enum": "ordinal",
          "_value": "targetEnum"
        }
      ]
    }
  ]
}
```
